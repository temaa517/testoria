<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ü—Ä–æ—Ñ–∏–ª—å - Testoria</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
</head>
<body>
    <!-- –®–∞–ø–∫–∞ —Å–∞–π—Ç–∞ -->
    <header class="header">
        <div class="container">
            <div class="header-inner">
                <div class="logo">
                    <h3>
                         <i class="fas fa-brain"></i>
                          Testoria
                    </h3>
                </div>
                <nav class="nav">
                    <a href="index.html" class="nav-link">
                        <i class="fas fa-home"></i>
                        –ì–ª–∞–≤–Ω–∞—è
                    </a>
                    <a href="catalog.html" class="nav-link">
                        <i class="fas fa-list"></i>
                        –ö–∞—Ç–∞–ª–æ–≥ —Ç–µ—Å—Ç–æ–≤
                    </a>
                    <a href="about.html" class="nav-link">
                        <i class="fas fa-info-circle"></i>
                        –û –Ω–∞—Å
                    </a>
                    <a href="contact.html" class="nav-link">
                        <i class="fas fa-phone"></i>
                        –ö–æ–Ω—Ç–∞–∫—Ç—ã
                    </a>
                </nav>
                <div class="header-controls">
                    <button class="theme-toggle" id="themeToggle" aria-label="–ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å –Ω–∞ —Ç–µ–º–Ω—É—é —Ç–µ–º—É">
                        <i class="fas fa-moon"></i>
                        <i class="fas fa-sun"></i>
                        <span class="theme-thumb"></span>
                    </button>
                    <!-- –ö–Ω–æ–ø–∫–∏ –≤—Ö–æ–¥–∞ (–ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è –∫–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω) -->
                    <div id="auth-buttons" class="auth-buttons">
                        <a href="login.html" class="btn btn-outline">–í–æ–π—Ç–∏</a>
                        <a href="register.html" class="btn btn-primary">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</a>
                    </div>

                    <!-- –ö–Ω–æ–ø–∫–∞ –ø—Ä–æ—Ñ–∏–ª—è (–ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –∫–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω) -->
                    <div id="profile-section" class="profile-dropdown" style="display: none;">
                        <button class="profile-btn" id="profileBtn">
                            üë§ –ü—Ä–æ—Ñ–∏–ª—å
                        </button>
                        <div class="dropdown-content" id="profileDropdown">
                            <a href="profile.html">–ú–æ–π –ø—Ä–æ—Ñ–∏–ª—å</a>
                            <a href="my-tests.html">–ú–æ–∏ —Ç–µ—Å—Ç—ã</a>
                            <a href="results.html">–†–µ–∑—É–ª—å—Ç–∞—Ç—ã</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <main class="page-content">
        <!-- –•–ª–µ–±–Ω—ã–µ –∫—Ä–æ—à–∫–∏ -->
        <section class="breadcrumbs">
            <div class="container">
                <nav class="breadcrumbs-nav">
                    <a href="index.html">–ì–ª–∞–≤–Ω–∞—è</a>
                    <i class="fas fa-chevron-right"></i>
                    <span>–ú–æ–π –ø—Ä–æ—Ñ–∏–ª—å</span>
                </nav>
            </div>
        </section>

        <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ —Å—Ç—Ä–∞–Ω–∏—Ü—ã -->
        <section class="profile-header">
            <div class="container">
                <div class="profile-header-content">
                    <h1 class="page-title">
                        <i class="fas fa-user-circle"></i>
                        –ú–æ–π –ø—Ä–æ—Ñ–∏–ª—å
                    </h1>
                    <p class="page-subtitle">–£–ø—Ä–∞–≤–ª—è–π—Ç–µ –≤–∞—à–∏–º –∞–∫–∫–∞—É–Ω—Ç–æ–º –∏ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–π—Ç–µ –ø—Ä–æ–≥—Ä–µ—Å—Å</p>
                </div>
            </div>
        </section>

        <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç –ø—Ä–æ—Ñ–∏–ª—è -->
        <section class="profile-content">
            <div class="container">
                <div class="profile-grid">
                    <!-- –ë–æ–∫–æ–≤–∞—è –ø–∞–Ω–µ–ª—å -->
                    <div class="profile-sidebar">
                        <div class="user-card">
                            <div class="user-avatar">
                                <i class="fas fa-user"></i>
                            </div>
                            <h3 id="userName">–ó–∞–≥—Ä—É–∑–∫–∞...</h3>
                            <p class="user-join-date" id="userJoinDate">–£—á–∞—Å—Ç–Ω–∏–∫ —Å ...</p>
                            <button class="btn btn-secondary btn-full" id="logoutProfile">
                                <i class="fas fa-sign-out-alt"></i>
                                –í—ã–π—Ç–∏
                            </button>
                        </div>

                        <div class="profile-nav">
                            <button class="nav-btn active" data-tab="stats">
                                <i class="fas fa-chart-bar"></i>
                                –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
                            </button>
                            <button class="nav-btn" data-tab="history">
                                <i class="fas fa-history"></i>
                                –ò—Å—Ç–æ—Ä–∏—è —Ç–µ—Å—Ç–æ–≤
                            </button>
                            <button class="nav-btn" data-tab="settings">
                                <i class="fas fa-cog"></i>
                                –ù–∞—Å—Ç—Ä–æ–π–∫–∏
                            </button>
                        </div>
                    </div>

                    <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç -->
                    <div class="profile-main">
                        <!-- –í–∫–ª–∞–¥–∫–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ -->
                        <div class="tab-content active" id="stats-tab">
                            <h2>
                                <i class="fas fa-chart-line"></i>
                                –í–∞—à–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
                            </h2>
                            <div class="stats-grid">
                                <div class="stat-card">
                                    <div class="stat-icon">
                                        <i class="fas fa-check-circle"></i>
                                    </div>
                                    <div class="stat-info">
                                        <span class="stat-value" id="testsCompleted">0</span>
                                        <span class="stat-label">–ü—Ä–æ–π–¥–µ–Ω–æ —Ç–µ—Å—Ç–æ–≤</span>
                                    </div>
                                </div>
                                <div class="stat-card">
                                    <div class="stat-icon">
                                        <i class="fas fa-clock"></i>
                                    </div>
                                    <div class="stat-info">
                                        <span class="stat-value" id="totalTime">0—á</span>
                                        <span class="stat-label">–û–±—â–µ–µ –≤—Ä–µ–º—è</span>
                                    </div>
                                </div>
                                <div class="stat-card">
                                    <div class="stat-icon">
                                        <i class="fas fa-trophy"></i>
                                    </div>
                                    <div class="stat-info">
                                        <span class="stat-value" id="achievementsCount">0</span>
                                        <span class="stat-label">–î–æ—Å—Ç–∏–∂–µ–Ω–∏—è</span>
                                    </div>
                                </div>
                            </div>

                            <div class="recent-activity">
                                <h3>–ù–µ–¥–∞–≤–Ω—è—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å</h3>
                                <div class="activity-list" id="recentActivity">
                                    <!-- –ë—É–¥–µ—Ç –∑–∞–ø–æ–ª–Ω–µ–Ω–æ —á–µ—Ä–µ–∑ JavaScript -->
                                </div>
                            </div>
                        </div>

                        <!-- –í–∫–ª–∞–¥–∫–∞ –∏—Å—Ç–æ—Ä–∏–∏ -->
                        <div class="tab-content" id="history-tab">
                            <h2>
                                <i class="fas fa-history"></i>
                                –ò—Å—Ç–æ—Ä–∏—è —Ç–µ—Å—Ç–æ–≤
                            </h2>
                            <div class="history-list" id="historyList">
                                <!-- –ë—É–¥–µ—Ç –∑–∞–ø–æ–ª–Ω–µ–Ω–æ —á–µ—Ä–µ–∑ JavaScript -->
                            </div>
                        </div>

                        <!-- –í–∫–ª–∞–¥–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫ -->
                        <div class="tab-content" id="settings-tab">
                            <h2>
                                <i class="fas fa-cog"></i>
                                –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∞–∫–∫–∞—É–Ω—Ç–∞
                            </h2>
                            <div class="settings-form">
                                <div class="form-group">
                                    <label for="userNameInput">–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</label>
                                    <input type="text" id="userNameInput" class="form-control">
                                </div>
                                <button class="btn btn-primary" id="saveUserName">
                                    <i class="fas fa-save"></i>
                                    –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- –§—É—Ç–µ—Ä -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h3>
                        <i class="fas fa-brain"></i>
                        Testoria
                    </h3>
                    <p>–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞ —É–≤–ª–µ–∫–∞—Ç–µ–ª—å–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ</p>
                    <div class="social-icons">
                        <a href="#" class="social-link">
                            <i class="fab fa-telegram"></i>
                        </a>
                    </div>
                </div>
                <div class="footer-section">
                    <h4>
                        <i class="fas fa-compass"></i>
                        –ù–∞–≤–∏–≥–∞—Ü–∏—è
                    </h4>
                    <a href="index.html">
                        <i class="fas fa-arrow-right"></i>
                        –ì–ª–∞–≤–Ω–∞—è
                    </a>
                    <a href="catalog.html">
                        <i class="fas fa-arrow-right"></i>
                        –ö–∞—Ç–∞–ª–æ–≥ —Ç–µ—Å—Ç–æ–≤
                    </a>
                    <a href="about.html">
                        <i class="fas fa-arrow-right"></i>
                        –û –Ω–∞—Å
                    </a>
                    <a href="contact.html">
                        <i class="fas fa-arrow-right"></i>
                        –ö–æ–Ω—Ç–∞–∫—Ç—ã
                    </a>
                </div>
                <div class="footer-section">
                    <h4>
                        <i class="fas fa-envelope"></i>
                        –ö–æ–Ω—Ç–∞–∫—Ç—ã
                    </h4>
                    <p>
                        <i class="fas fa-envelope"></i>
                        Email: hello@testoria.cloud
                    </p>
                    <p>
                        <i class="fas fa-phone"></i>
                        –¢–µ–ª–µ—Ñ–æ–Ω: +375 (01) 234-56-78
                    </p>
                    <p>
                        <i class="fas fa-map-marker-alt"></i>
                        –ê–¥—Ä–µ—Å: –≥. –ú–∏–Ω—Å–∫, —É–ª. –£—Ä—É—á—Å–∫–∞—è, 81–ë
                    </p>
                </div>
            </div>
            <div class="footer-bottom">
                <p>
                    <i class="far fa-copyright"></i>
                    2025 Testoria. –í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã.
                </p>
            </div>
        </div>
    </footer>

    <!-- JavaScript -->
    <script>
        // –ü–†–û–°–¢–´–ï –ì–õ–û–ë–ê–õ–¨–ù–´–ï –§–£–ù–ö–¶–ò–ò
        function logout() {
            console.log('üî¥ –í—ã—Ö–æ–¥ –∏–∑ –∞–∫–∫–∞—É–Ω—Ç–∞');
            
            // –û—á–∏—â–∞–µ–º –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
            localStorage.removeItem('isLoggedIn');
            localStorage.removeItem('testoria_current_user');
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ
            alert('–í—ã —É—Å–ø–µ—à–Ω–æ –≤—ã—à–ª–∏ –∏–∑ –∞–∫–∫–∞—É–Ω—Ç–∞!');
            
            // –ü–µ—Ä–µ—Ö–æ–¥–∏–º –Ω–∞ –≥–ª–∞–≤–Ω—É—é
            window.location.href = 'index.html';
        }

        function confirmLogout() {
            if (confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ –≤—ã–π—Ç–∏ –∏–∑ –∞–∫–∫–∞—É–Ω—Ç–∞?')) {
                logout();
            }
        }

        function updateUserName() {
            const newName = document.getElementById('userNameInput').value.trim();
            if (!newName) {
                alert('–í–≤–µ–¥–∏—Ç–µ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è');
                return;
            }

            try {
                // –ü—Ä–æ—Å—Ç–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–º–µ–Ω–∏ –≤ localStorage
                const userData = JSON.parse(localStorage.getItem('testoria_current_user') || '{}');
                userData.name = newName;
                localStorage.setItem('testoria_current_user', JSON.stringify(userData));
                
                alert('–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–æ!');
                location.reload();
            } catch (error) {
                alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ –∏–º–µ–Ω–∏: ' + error.message);
            }
        }

        // Profile Manager
        class ProfileManager {
            constructor() {
                this.currentUser = null;
                this.init();
            }

            init() {
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é
                const isLoggedIn = localStorage.getItem('isLoggedIn') === 'true';
                if (!isLoggedIn) {
                    window.location.href = 'login.html';
                    return;
                }
                
                this.loadUserData();
                this.setupEventListeners();
                this.loadProfileData();
            }

            loadUserData() {
                try {
                    const userData = localStorage.getItem('testoria_current_user');
                    if (userData) {
                        this.currentUser = JSON.parse(userData);
                    }
                } catch (error) {
                    console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:', error);
                }
            }

            setupEventListeners() {
                // –ö–Ω–æ–ø–∫–∏ –≤—ã—Ö–æ–¥–∞
                document.getElementById('logoutHeader')?.addEventListener('click', (e) => {
                    e.preventDefault();
                    confirmLogout();
                });
                
                document.getElementById('logoutProfile')?.addEventListener('click', () => {
                    confirmLogout();
                });

                // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏–º–µ–Ω–∏
                document.getElementById('saveUserName')?.addEventListener('click', () => {
                    updateUserName();
                });

                // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –≤–∫–ª–∞–¥–æ–∫
                document.querySelectorAll('.nav-btn').forEach(btn => {
                    btn.addEventListener('click', () => {
                        const tab = btn.dataset.tab;
                        this.switchTab(tab);
                    });
                });

                // –í—ã–ø–∞–¥–∞—é—â–µ–µ –º–µ–Ω—é –ø—Ä–æ—Ñ–∏–ª—è
                document.getElementById('profileBtn')?.addEventListener('click', () => {
                    this.toggleProfileMenu();
                });
            }

            toggleProfileMenu() {
                const dropdown = document.getElementById('profileDropdown');
                if (dropdown.style.display === 'block') {
                    dropdown.style.display = 'none';
                } else {
                    dropdown.style.display = 'block';
                // –ó–∞–∫—Ä—ã—Ç–∏–µ –ø—Ä–∏ –∫–ª–∏–∫–µ –≤–Ω–µ –º–µ–Ω—é
                    setTimeout(() => {
                        document.addEventListener('click', this.closeProfileMenu.bind(this), { once: true });
                    }, 0);
                }
            }

            closeProfileMenu(e) {
                const dropdown = document.getElementById('profileDropdown');
                const profileBtn = document.getElementById('profileBtn');
                if (!dropdown.contains(e.target) && !profileBtn.contains(e.target)) {
                    dropdown.style.display = 'none';
                }
            }

            switchTab(tabName) {
                // –û–±–Ω–æ–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—ã–µ –∫–Ω–æ–ø–∫–∏
                document.querySelectorAll('.nav-btn').forEach(btn => {
                    btn.classList.remove('active');
                });
                document.querySelector(`[data-tab="${tabName}"]`)?.classList.add('active');

                // –û–±–Ω–æ–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—ã–µ –≤–∫–ª–∞–¥–∫–∏
                document.querySelectorAll('.tab-content').forEach(tab => {
                    tab.classList.remove('active');
                });
                document.getElementById(`${tabName}-tab`)?.classList.add('active');
            }

            loadProfileData() {
                if (!this.currentUser) return;

                // –û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
                document.getElementById('userName').textContent = this.currentUser.name || '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å';
                document.getElementById('userNameInput').value = this.currentUser.name || '';
                
                // –î–∞—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
                const joinDate = this.currentUser.createdAt ? 
                    new Date(this.currentUser.createdAt).toLocaleDateString('ru-RU') : 
                    new Date().toLocaleDateString('ru-RU');
                document.getElementById('userJoinDate').textContent = `–£—á–∞—Å—Ç–Ω–∏–∫ —Å ${joinDate}`;

                // –°–¢–ê–¢–ò–°–¢–ò–ö–ê –ò–ó –†–ï–ó–£–õ–¨–¢–ê–¢–û–í –¢–ï–°–¢–û–í
                const allResults = JSON.parse(localStorage.getItem('testResults')) || [];
                const userResults = allResults.filter(result => result.userId === this.currentUser.id);
                
                const testsCompleted = userResults.length;
                const totalTime = userResults.reduce((total, test) => total + (test.timeSpent || 0), 0);
                
                document.getElementById('testsCompleted').textContent = testsCompleted;
                document.getElementById('totalTime').textContent = this.formatTime(totalTime);
                document.getElementById('achievementsCount').textContent = this.calculateAchievements(testsCompleted);

                // –ò—Å—Ç–æ—Ä–∏—è –∏ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å
                this.loadHistory();
                this.loadRecentActivity();
            }

            // –£–ø—Ä–æ—â–µ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π (—Ç–æ–ª—å–∫–æ –∑–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–µ—Å—Ç–æ–≤)
            calculateAchievements(testsCount) {
                if (testsCount >= 10) return 3;
                if (testsCount >= 5) return 2;
                if (testsCount >= 1) return 1;
                return 0;
            }

            loadHistory() {
                const historyList = document.getElementById('historyList');
                
                // –ë–µ—Ä–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∏–∑ localStorage
                const allResults = JSON.parse(localStorage.getItem('testResults')) || [];
                const userResults = allResults.filter(result => result.userId === this.currentUser.id);
                
                console.log('–ó–∞–≥—Ä—É–∂–∞–µ–º –∏—Å—Ç–æ—Ä–∏—é —Ç–µ—Å—Ç–æ–≤:', userResults);
                
                if (userResults.length === 0) {
                    historyList.innerHTML = `
                        <div class="empty-state">
                            <i class="fas fa-history"></i>
                            <h3>–ò—Å—Ç–æ—Ä–∏—è —Ç–µ—Å—Ç–æ–≤ –ø—É—Å—Ç–∞</h3>
                            <p>–ü—Ä–æ–π–¥–∏—Ç–µ —Å–≤–æ–π –ø–µ—Ä–≤—ã–π —Ç–µ—Å—Ç, —á—Ç–æ–±—ã —É–≤–∏–¥–µ—Ç—å –µ–≥–æ –∑–¥–µ—Å—å!</p>
                            <a href="catalog.html" class="btn btn-primary">–ù–∞–π—Ç–∏ —Ç–µ—Å—Ç</a>
                        </div>
                    `;
                    return;
                }

                // –°–æ—Ä—Ç–∏—Ä—É–µ–º –ø–æ –¥–∞—Ç–µ (–Ω–æ–≤—ã–µ —Å–≤–µ—Ä—Ö—É)
                const sortedResults = userResults.sort((a, b) => new Date(b.completedAt) - new Date(a.completedAt));
                
                historyList.innerHTML = sortedResults.map(test => `
                    <div class="history-item">
                        <div class="test-info">
                            <h4>${test.testTitle || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π —Ç–µ—Å—Ç'}</h4>
                            <p class="test-description">–ü—Ä–æ–π–¥–µ–Ω–æ –≤–æ–ø—Ä–æ—Å–æ–≤: ${test.totalQuestions || '?'}</p>
                        </div>
                        <div class="test-meta">
                            <span class="test-date">${new Date(test.completedAt).toLocaleDateString('ru-RU')}</span>
                            <span class="test-time">${this.formatTime(test.timeSpent || 0)}</span>
                        </div>
                    </div>
                `).join('');
            }

            loadRecentActivity() {
                const activityList = document.getElementById('recentActivity');
                
                // –ë–µ—Ä–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∏–∑ localStorage
                const allResults = JSON.parse(localStorage.getItem('testResults')) || [];
                const userResults = allResults.filter(result => result.userId === this.currentUser.id);
                const recentTests = userResults.slice(0, 5).reverse(); // –ü–æ—Å–ª–µ–¥–Ω–∏–µ 5
                
                if (recentTests.length === 0) {
                    activityList.innerHTML = '<p class="no-activity">–ù–µ—Ç –Ω–µ–¥–∞–≤–Ω–µ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏</p>';
                    return;
                }

                activityList.innerHTML = recentTests.map(test => `
                    <div class="activity-item">
                        <i class="fas fa-check-circle"></i>
                        <div class="activity-content">
                            <span class="activity-text">–ü—Ä–æ–π–¥–µ–Ω —Ç–µ—Å—Ç "${test.testTitle || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π —Ç–µ—Å—Ç'}"</span>
                            <span class="activity-time">${this.formatRelativeTime(test.completedAt)}</span>
                        </div>
                    </div>
                `).join('');
            }

            formatTime(seconds) {
                const hours = Math.floor(seconds / 3600);
                const minutes = Math.floor((seconds % 3600) / 60);
                const secs = seconds % 60;
                
                if (hours > 0) {
                    return `${hours}—á ${minutes}–º`;
                } else if (minutes > 0) {
                    return `${minutes}–º ${secs}—Å`;
                } else {
                    return `${secs}—Å`;
                }
            }

            formatRelativeTime(dateString) {
                const date = new Date(dateString);
                const now = new Date();
                const diffMs = now - date;
                const diffMins = Math.floor(diffMs / 60000);
                const diffHours = Math.floor(diffMins / 60);
                const diffDays = Math.floor(diffHours / 24);

                if (diffMins < 1) return '—Ç–æ–ª—å–∫–æ —á—Ç–æ';
                if (diffMins < 60) return `${diffMins} –º–∏–Ω –Ω–∞–∑–∞–¥`;
                if (diffHours < 24) return `${diffHours} —á –Ω–∞–∑–∞–¥`;
                if (diffDays < 7) return `${diffDays} –¥ –Ω–∞–∑–∞–¥`;
                return date.toLocaleDateString('ru-RU');
            }
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        document.addEventListener('DOMContentLoaded', () => {
            new ThemeManager();
            new ProfileManager();
        });
    </script>

<script src="auth-core.js"></script>
<script src="auth-header.js"></script>
<script src="js/profile-core.js"></script>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é
        const userManager = new UserManager();
        if (!userManager.getCurrentUser()) {
            window.location.href = 'login.html';
            return;
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –ø—Ä–æ—Ñ–∏–ª—å
        new ProfileManager();
    });
</script>
</body>
</html>